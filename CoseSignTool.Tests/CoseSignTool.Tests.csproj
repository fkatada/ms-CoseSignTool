<Project Sdk="Microsoft.NET.Sdk">
	<PropertyGroup>
		<TargetFramework>net8.0</TargetFramework>
		<Platforms>AnyCPU</Platforms>
		<!-- must match the platform set from CoseSignTool	-->
		<Nullable>enable</Nullable>
		<IsPublishable>false</IsPublishable>
		<EnablePreviewFeatures>true</EnablePreviewFeatures>
		<EnforceCodeStyleInBuild>True</EnforceCodeStyleInBuild>
		<SignAssembly>True</SignAssembly>
		<PublicSign>True</PublicSign>
		<AssemblyOriginatorKeyFile>..\StrongNameKeys\35MSSharedLib1024.snk</AssemblyOriginatorKeyFile>
		<IsTestProject>True</IsTestProject>
	</PropertyGroup>

	<PropertyGroup>
		<!-- other property settings -->
<!--		<ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>None</ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
		<TestingPlatformShowTestsFailure>true</TestingPlatformShowTestsFailure>-->
	</PropertyGroup>

	<ItemGroup>
		<!-- Because this is a test project, don't run code coverage -->
		<AssemblyAttribute Include="System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute" />
	</ItemGroup>

	<!-- Package references -->
	<ItemGroup>
		<PackageReference Include="FluentAssertions" Version="6.12.1" />
		<PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.11.1" />
		<PackageReference Include="MSTest.TestAdapter" Version="3.6.1" />
		<PackageReference Include="MSTest.TestFramework" Version="3.6.1" />
	</ItemGroup>

	<!-- Project references -->
	<ItemGroup>
		<ProjectReference Include="..\CoseSign1.Tests.Common\CoseSign1.Tests.Common.csproj" />
		<ProjectReference Include="..\CoseSignTool\CoseSignTool.csproj" />
	</ItemGroup>

	<!-- Copy to output -->
	<ItemGroup>
	  <None Update="TestData\payload.json">
	    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
	  </None>
	  <None Update="TestData\signature.cose">
	    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
	  </None>
	</ItemGroup>

	<Target Name="CopyCustomContent" AfterTargets="AfterBuild">
		<ItemGroup>
			<AssetsSourceFiles Include="$(ProjectDir)TestData\**"/>
		</ItemGroup>		
		<Message Importance="High" Text="+++++++++++++++++++++++ Copying @(AssetsSourceFiles) to $(TargetDir). Project directory is $(ProjectDir) ++++++++++++++++++++++++++++++++++++" />
		<Copy SourceFiles="@(AssetsSourceFiles)" DestinationFolder="$(TargetDir)" SkipUnchangedFiles="true" />
		<Message Importance="High" Text="+++++++++++++++++++++++ @(AssetsSourceFiles) to $(TargetDir) ++++++++++++++++++++++++++++++++++++" />
	</Target>	  			  	

</Project>
